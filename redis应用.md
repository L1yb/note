# 

## 一、简介

### redis 简介

（remote dictionary service)(远程字典服务)

它是：

- key-value数据库
- 数据结构数据库 string 、list 、hash、set 、zset

	- 内存数据库 ，所有数据都在内存里

### 特性：

1、string

c++ 	stl 	string 	二进制安全字符串 以长度限定，而不是分隔符（例如c语言\0）

| hash | k    | v      |
| ---- | ---- | ------ |
|      |      | string |

2、 list

插入有序

| hash | k    | v                      |
| ---- | ---- | ---------------------- |
|      |      | e1 <--> e2 <---> e3... |

3、hash

**无序**结构，散链表，



| hash | k    | v            |
| ---- | ---- | ------------ |
|      |      | field, value |
|		|		|field, value|



- 通过field确定**唯一**的value
- field排列是**无序**的

​	

4、set无序集合

**唯一，无序**

| set  | key  |	value|
| ---- | ---- |----  |
|      |      | [m1,m2,m3,m4] |



5、zset 有序集合

**唯一，有序**

| zset | key  | value                     |
| ---- | ---- | ------------------------- |
|      |      | [{c1,m1}, {c2, m2}, ....] |

- 唯一由member确定
- 有序由score决定



## 二、 使用





### 1、 分布锁、签到功能 ：string

**锁**只允许有一个持有者

加锁：通过setnx（set not exist）的返回值判断是否加锁成功(1 成功 0 失败)

解锁：del key val



需要考虑的问题：

1. redis服务器是否宕机了，其他分布式是否还存在
2. 加锁进程宕机了（也就无法释放了），导致其他进程无法加锁



**签到功能**

app 留存  	**签到**     	一个月签到多少次（仅次数）

​			**二进制操作**   	  31 string  0101101通过1的数量就知道次数






| redis |key | string | 单个key |相同功能多个key|
|---|---|---|--|--|
| 	|	|	|有意义字段	|s1:s2	|



命令：

```bash
#sign签到，用户id：10001 2024年9月份  1号 签到成功（）
setbit sign:10001:202409  1  1
#统计用户10001的2024年9月的签到情况
BITCOUNT sign:10001:202409
```




功能名：用户id：唯一标识
为什么使用的是“：” 客户端工具会使用”：“作为分隔符生成文件目录树



### 2、 栈、队列 ：list 







